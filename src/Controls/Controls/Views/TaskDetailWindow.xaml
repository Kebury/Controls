<Window x:Class="Controls.Views.TaskDetailWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:helpers="clr-namespace:Controls.Helpers"
        mc:Ignorable="d"
        Title="Детали задания" 
        Height="700" Width="900"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource SecondaryBackground}">
    
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <helpers:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter"/>
        <helpers:IsNotNullOrEmptyConverter x:Key="IsNotNullOrEmptyConverter"/>
    </Window.Resources>
    
    <Grid Margin="30">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Margin="0,0,0,25">
            <TextBlock Text="{Binding Task.Title}" 
                       FontSize="24" 
                       FontWeight="Bold" 
                       Foreground="{DynamicResource PrimaryText}"
                       TextWrapping="Wrap"/>
            
            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                <Border Background="{DynamicResource ButtonPrimary}" 
                        CornerRadius="3" 
                        Padding="10,4"
                        Margin="0,0,10,0">
                    <TextBlock Text="{Binding Task.TaskTypeDisplay}" 
                               Foreground="White" 
                               FontSize="12"
                               FontWeight="SemiBold"/>
                </Border>

                <Border Background="{DynamicResource ButtonSuccess}" 
                        CornerRadius="3" 
                        Padding="10,4"
                        Margin="0,0,10,0">
                    <TextBlock Text="{Binding Task.Status}"
                               Foreground="White" 
                               FontSize="12"
                               FontWeight="SemiBold"/>
                </Border>
            </StackPanel>
        </StackPanel>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <TabControl>
                <TabItem Header="📋 Основная информация" FontSize="14" FontWeight="SemiBold">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,10,0,0">
                        <StackPanel>
                            <Border Background="{DynamicResource PrimaryBackground}" 
                        BorderBrush="{DynamicResource PrimaryBorder}" 
                        BorderThickness="1"
                        CornerRadius="8" 
                        Padding="20"
                        Margin="0,0,0,15">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Margin="0,0,10,0">
                            <TextBlock Text="Важность" 
                                       FontSize="13" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       Margin="0,0,0,5"/>
                            <TextBlock Text="{Binding Task.ImportanceDisplay}" 
                                       FontSize="16" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource ButtonDanger}"/>
                        </StackPanel>

                        <StackPanel Grid.Column="1" Margin="10,0,0,0">
                            <TextBlock Text="Срочность" 
                                       FontSize="13" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       Margin="0,0,0,5"/>
                            <TextBlock Text="{Binding Task.UrgencyDisplay}" 
                                       FontSize="16" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource AccentOrange}"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <Border Background="{DynamicResource PrimaryBackground}" 
                        BorderBrush="{DynamicResource PrimaryBorder}" 
                        BorderThickness="1"
                        CornerRadius="8" 
                        Padding="20"
                        Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="📋 Номер и сроки" 
                                   FontSize="16" 
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource PrimaryText}"
                                   Margin="0,0,0,15"/>

                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Номер задания" 
                                       FontSize="13" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       Margin="0,0,0,5"/>
                            <TextBlock Text="{Binding Task.ControlNumber}" 
                                       FontSize="14" 
                                       Foreground="{DynamicResource PrimaryText}"/>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Срок исполнения" 
                                       FontSize="13" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       Margin="0,0,0,5"/>
                            <TextBlock Text="{Binding Task.DueDate, StringFormat='dd.MM.yyyy HH:mm'}" 
                                       FontSize="14" 
                                       Foreground="{DynamicResource PrimaryText}"
                                       FontWeight="SemiBold"/>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Дата поступления" 
                                       FontSize="13" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       Margin="0,0,0,5"/>
                            <TextBlock Text="{Binding Task.CreatedDate, StringFormat='dd.MM.yyyy HH:mm'}" 
                                       FontSize="14" 
                                       Foreground="{DynamicResource PrimaryText}"/>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,12"
                                    Visibility="{Binding Task.CompletedDate, Converter={StaticResource BoolToVisibilityConverter}}">
                            <TextBlock Text="Дата фактического исполнения" 
                                       FontSize="13" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       Margin="0,0,0,5"/>
                            <TextBlock Text="{Binding Task.CompletedDate, StringFormat='dd.MM.yyyy HH:mm'}" 
                                       FontSize="14" 
                                       Foreground="{DynamicResource ButtonSuccess}"
                                       FontWeight="SemiBold"/>
                        </StackPanel>

                        <Button Content="📄 Открыть основной документ"
                                Command="{Binding OpenControlDocumentCommand}"
                                Background="{DynamicResource ButtonPrimary}"
                                Foreground="White"
                                FontSize="13"
                                Padding="15,10"
                                BorderThickness="0"
                                Cursor="Hand"
                                HorizontalAlignment="Left">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="5"
                                                        Padding="{TemplateBinding Padding}">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#2980B9"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                    </StackPanel>
                </Border>

                <Border Background="{DynamicResource PrimaryBackground}" 
                        BorderBrush="{DynamicResource PrimaryBorder}" 
                        BorderThickness="1"
                        CornerRadius="8" 
                        Padding="20"
                        Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="📝 Содержание задания" 
                                   FontSize="16" 
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource PrimaryText}"
                                   Margin="0,0,0,10"/>
                        <TextBlock Text="{Binding Task.Description}" 
                                   FontSize="14" 
                                   Foreground="{DynamicResource PrimaryText}"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>

                <Border Background="{DynamicResource PrimaryBackground}" 
                        BorderBrush="{DynamicResource PrimaryBorder}" 
                        BorderThickness="1"
                        CornerRadius="8" 
                        Padding="20"
                        Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="👤 Исполнитель" 
                                   FontSize="16" 
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource PrimaryText}"
                                   Margin="0,0,0,10"/>
                        <TextBlock FontSize="14" 
                                   Foreground="{DynamicResource PrimaryText}">
                            <Run Text="{Binding Task.Assignee, Mode=OneWay}"/>
                        </TextBlock>
                    </StackPanel>
                </Border>

                <Border Background="{DynamicResource PrimaryBackground}" 
                        BorderBrush="{DynamicResource PrimaryBorder}" 
                        BorderThickness="1"
                        CornerRadius="8" 
                        Padding="20"
                        Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="� Ответы" 
                                   FontSize="16" 
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource PrimaryText}"
                                   Margin="0,0,0,15"/>

                        <Button Content="📋 Открыть шаблон ответа"
                                Command="{Binding OpenReportTemplateCommand}"
                                Background="{DynamicResource ButtonSuccess}"
                                Foreground="White"
                                FontSize="13"
                                Padding="15,10"
                                BorderThickness="0"
                                Cursor="Hand"
                                HorizontalAlignment="Left"
                                Margin="0,0,0,10">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="5"
                                                        Padding="{TemplateBinding Padding}">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#229954"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>

                        <Button Content="📁 Открыть папку с донесениями"
                                Command="{Binding OpenReportsFolderCommand}"
                                Background="{DynamicResource AccentPurple}"
                                Foreground="White"
                                FontSize="13"
                                Padding="15,10"
                                BorderThickness="0"
                                Cursor="Hand"
                                HorizontalAlignment="Left">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="5"
                                                        Padding="{TemplateBinding Padding}">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#8E44AD"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                    </StackPanel>
                </Border>

                <Border Background="{DynamicResource PrimaryBackground}" 
                        BorderBrush="{DynamicResource PrimaryBorder}" 
                        BorderThickness="1"
                        CornerRadius="8" 
                        Padding="20"
                        Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="💡 Примечания" 
                                   FontSize="16" 
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource PrimaryText}"
                                   Margin="0,0,0,10"/>
                        <TextBlock Text="{Binding Task.Notes}" 
                                   FontSize="14" 
                                   Foreground="{DynamicResource PrimaryText}"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>

                <Border Background="{DynamicResource PrimaryBackground}" 
                        BorderBrush="{DynamicResource PrimaryBorder}" 
                        BorderThickness="1"
                        CornerRadius="8" 
                        Padding="20">
                    <StackPanel>
                        <TextBlock Text="📎 Приложенные документы" 
                                   FontSize="16" 
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource PrimaryText}"
                                   Margin="0,0,0,15"/>

                        <ItemsControl ItemsSource="{Binding Task.Documents}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource SecondaryBackground}" 
                                            BorderBrush="{DynamicResource PrimaryBorder}"
                                            BorderThickness="1"
                                            CornerRadius="5" 
                                            Padding="12"
                                            Margin="0,0,0,8"
                                            Cursor="Hand">
                                        <Border.InputBindings>
                                            <MouseBinding Gesture="LeftClick" 
                                                          Command="{Binding DataContext.OpenDocumentCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                          CommandParameter="{Binding}"/>
                                        </Border.InputBindings>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0" 
                                                       Text="📄" 
                                                       FontSize="20"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,10,0"/>

                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock Text="{Binding FileName}" 
                                                           FontSize="14" 
                                                           FontWeight="SemiBold"
                                                           Foreground="{DynamicResource PrimaryText}"
                                                           TextWrapping="NoWrap"
                                                           TextTrimming="CharacterEllipsis"/>
                                                <TextBlock FontSize="12" Foreground="{DynamicResource SecondaryText}" Margin="0,3,0,0">
                                                    <Run Text="{Binding FileType}"/>
                                                    <Run Text="•"/>
                                                    <Run Text="{Binding AddedDate, StringFormat='Добавлен: {0:dd.MM.yyyy}'}"/>
                                                </TextBlock>
                                                <TextBlock Text="{Binding Description}" 
                                                           FontSize="12" 
                                                           Foreground="{DynamicResource TertiaryText}"
                                                           TextWrapping="Wrap"
                                                           Margin="0,3,0,0">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Description, Converter={StaticResource IsNotNullOrEmptyConverter}}" Value="True">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </StackPanel>

                                            <Button Grid.Column="2"
                                                    Command="{Binding DataContext.OpenDocumentCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding}"
                                                    Background="{DynamicResource ButtonPrimary}"
                                                    Foreground="White"
                                                    FontSize="12"
                                                    Padding="10,5"
                                                    BorderThickness="0"
                                                    Cursor="Hand"
                                                    VerticalAlignment="Center">
                                                <TextBlock Text="Открыть"/>
                                                <Button.Style>
                                                    <Style TargetType="Button">
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="Button">
                                                                    <Border Background="{TemplateBinding Background}"
                                                                            CornerRadius="4"
                                                                            Padding="{TemplateBinding Padding}">
                                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                    </Border>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                        <Style.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#2980B9"/>
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <TextBlock Text="Нет приложенных документов" 
                                   FontSize="13" 
                                   Foreground="{DynamicResource TertiaryText}"
                                   FontStyle="Italic">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasDocuments}" Value="False">
                                            <Setter Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </StackPanel>
                </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

                <TabItem Header="📜 История" FontSize="14" FontWeight="SemiBold">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,10,0,0">
                        <StackPanel>
                            <TextBlock Text="История выполнения задания" 
                                       FontSize="18" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource PrimaryText}"
                                       Margin="0,0,0,15"/>
                            
                            <Border Background="{DynamicResource PrimaryBackground}" 
                                    BorderBrush="{DynamicResource PrimaryBorder}" 
                                    BorderThickness="1"
                                    CornerRadius="8" 
                                    Padding="20">
                                <StackPanel>
                                    <TextBlock FontSize="14" 
                                               Foreground="{DynamicResource SecondaryText}"
                                               TextWrapping="Wrap"
                                               Margin="0,0,0,15">
                                        <Run Text="Задание поступило:"/>
                                        <Run Text="{Binding Task.CreatedDate, StringFormat='dd.MM.yyyy HH:mm'}" FontWeight="SemiBold"/>
                                    </TextBlock>
                                    
                                    <TextBlock FontSize="14" 
                                               Foreground="{DynamicResource SecondaryText}"
                                               TextWrapping="Wrap"
                                               Margin="0,0,0,15">
                                        <Run Text="Срок исполнения:"/>
                                        <Run Text="{Binding Task.DueDate, StringFormat='dd.MM.yyyy HH:mm'}" FontWeight="SemiBold"/>
                                    </TextBlock>
                                    
                                    <TextBlock FontSize="14" 
                                               Foreground="{DynamicResource SecondaryText}"
                                               TextWrapping="Wrap"
                                               Margin="0,0,0,15">
                                        <Run Text="Текущий статус:"/>
                                        <Run Text="{Binding Task.Status}" FontWeight="SemiBold"/>
                                    </TextBlock>
                                    
                                    <Border Background="{DynamicResource AccentAmber}"
                                            CornerRadius="5"
                                            Padding="10,5"
                                            HorizontalAlignment="Left"
                                            Margin="0,0,0,10">
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                <Style.Triggers>
                                                    <MultiDataTrigger>
                                                        <MultiDataTrigger.Conditions>
                                                            <Condition Binding="{Binding Task.CompletedDate, Converter={StaticResource IsNotNullOrEmptyConverter}}" Value="Visible"/>
                                                            <Condition Binding="{Binding Task.Status}" Value="На исполнении"/>
                                                        </MultiDataTrigger.Conditions>
                                                        <Setter Property="Visibility" Value="Visible"/>
                                                    </MultiDataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                        <StackPanel>
                                            <TextBlock Text="⚡ Промежуточное исполнение"
                                                       FontSize="14"
                                                       FontWeight="SemiBold"
                                                       Foreground="White"
                                                       Margin="0,0,0,5"/>
                                            <TextBlock FontSize="13" 
                                                       Foreground="White">
                                                <Run Text="{Binding Task.CompletedDate, StringFormat='dd.MM.yyyy HH:mm'}"/>
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>
                                    
                                    <Border Background="{DynamicResource ButtonSuccess}"
                                            CornerRadius="5"
                                            Padding="10,5"
                                            HorizontalAlignment="Left"
                                            Margin="0,0,0,10">
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Task.Status}" Value="Исполнено">
                                                        <Setter Property="Visibility" Value="Visible"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                        <StackPanel>
                                            <TextBlock Text="✓ Задание исполнено"
                                                       FontSize="14"
                                                       FontWeight="SemiBold"
                                                       Foreground="White"
                                                       Margin="0,0,0,5"/>
                                            <TextBlock FontSize="13" 
                                                       Foreground="White">
                                                <Run Text="Дата завершения:"/>
                                                <Run Text="{Binding Task.CompletedDate, StringFormat='dd.MM.yyyy HH:mm'}"/>
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>
                                    
                                    <Border Background="{DynamicResource SecondaryBackground}"
                                            BorderBrush="{DynamicResource PrimaryBorder}"
                                            BorderThickness="1"
                                            CornerRadius="5"
                                            Padding="15"
                                            Margin="0,0,0,10"
                                            Visibility="{Binding IntermediateResponses.Count, Converter={StaticResource CountToVisibilityConverter}}">
                                        <StackPanel>
                                            <TextBlock Text="📝 История исполнения"
                                                       FontSize="15"
                                                       FontWeight="SemiBold"
                                                       Foreground="{DynamicResource PrimaryText}"
                                                       Margin="0,0,0,10"/>
                                            
                                            <ItemsControl ItemsSource="{Binding IntermediateResponses}">
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Background="{DynamicResource PrimaryBackground}"
                                                                BorderBrush="{DynamicResource PrimaryBorder}"
                                                                BorderThickness="1"
                                                                CornerRadius="4"
                                                                Padding="10"
                                                                Margin="0,0,0,8">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="*"/>
                                                                </Grid.ColumnDefinitions>
                                                                
                                                                <TextBlock Text="✓"
                                                                           FontSize="16"
                                                                           Foreground="{DynamicResource AccentGreen}"
                                                                           Margin="0,0,10,0"
                                                                           VerticalAlignment="Center"/>
                                                                
                                                                <StackPanel Grid.Column="1">
                                                                    <TextBlock Text="{Binding DisplayText}"
                                                                               FontSize="14"
                                                                               FontWeight="SemiBold"
                                                                               Foreground="{DynamicResource PrimaryText}"
                                                                               TextWrapping="Wrap"/>
                                                                    <TextBlock Text="{Binding DateDisplay}"
                                                                               FontSize="12"
                                                                               Foreground="{DynamicResource SecondaryText}"
                                                                               Margin="0,3,0,0"/>
                                                                </StackPanel>
                                                            </Grid>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
            </TabControl>
        </ScrollViewer>

        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom">
            <Button Content="✅"
                    Command="{Binding MarkAsCompletedCommand}"
                    Background="{DynamicResource ButtonSuccess}"
                    Foreground="White"
                    FontSize="18"
                    Width="40"
                    Height="40"
                    BorderThickness="0"
                    Cursor="Hand"
                    Margin="0,0,10,0"
                    ToolTip="Отметить исполненным">
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}"
                                            CornerRadius="20"
                                            Width="{TemplateBinding Width}"
                                            Height="{TemplateBinding Height}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{DynamicResource ButtonSuccessHover}"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>

            <Button Content="✏️"
                    Command="{Binding EditCommand}"
                    Background="{DynamicResource ButtonPrimary}"
                    Foreground="White"
                    FontSize="18"
                    Width="40"
                    Height="40"
                    BorderThickness="0"
                    Cursor="Hand"
                    ToolTip="Редактировать задание">
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}"
                                            CornerRadius="20"
                                            Width="{TemplateBinding Width}"
                                            Height="{TemplateBinding Height}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#1976D2"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>
        </StackPanel>

        <StackPanel Grid.Row="2"
                    HorizontalAlignment="Center"
                    Margin="0,20,0,0">
            <Button Content="Закрыть"
                    Command="{Binding CloseCommand}"
                Background="{DynamicResource ButtonSecondary}"
                Foreground="White"
                FontSize="14"
                FontWeight="SemiBold"
                Padding="30,12"
                BorderThickness="0"
                Cursor="Hand"
                HorizontalAlignment="Center"
                Margin="0,20,0,0">
            <Button.Style>
                <Style TargetType="Button">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}"
                                        CornerRadius="5"
                                        Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#7F8C8D"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>
        </StackPanel>
    </Grid>
</Window>
